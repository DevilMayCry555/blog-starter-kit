import"./vendor-others.11f5dab8.js";import{T as I,M as w}from"./TaskPreview.ff3431fd.js";import{A}from"./Status.a3113516.js";import{F as h,_ as k,i as S,P as b}from"./index.5f82e941.js";import{P as N}from"./Pagination.6e5dfe4b.js";import{s as R,K as E,q as F,e as L,D as g}from"./vendor-element-plus.4011bc9f.js";import{d as f,ak as o,o as a,e as n,Q as d,ah as y,f as q,R as s,I as _,O as P,P as z}from"./vendor-@vue.e467cd49.js";import{a2 as D}from"./vendor-fortawesome.8c26b529.js";import"./vendor-highlight.js.5674318b.js";import"./CopyToClipboard.27b2f89b.js";import"./application.ea1e2a72.js";import"./vendor-markdown.2cd127bb.js";import"./vendor-axios.938e43d7.js";import"./vendor-qrcode.f15bf907.js";const G=f({name:"TaskFullList",components:{TaskPreview:I,Pagination:N,ElSkeleton:R,ElSkeletonItem:E,ElCard:F},emits:["update:modelValue","custom","refresh"],data(){return{job:void 0}},computed:{page(){var e;return parseInt(((e=this.$route.query.page)==null?void 0:e.toString())||"1")},total(){return this.$store.state.midjourney.imagineTasksTotal},offset(){return(this.page-1)*this.limit},limit(){return 12},loading(){return this.$store.state.midjourney.status.getApplication===h.Request},tasks(){return this.$store.state.midjourney.imagineTasks},application(){return this.$store.state.midjourney.application}},watch:{page:{async handler(){await this.$store.dispatch("midjourney/setImagineTasks",void 0),this.getImagineTasks()}},tasks:{handler(e,t){e&&t&&JSON.stringify(e)!==JSON.stringify(t)&&this.$emit("refresh",e)},deep:!0}},async mounted(){await this.$store.dispatch("midjourney/setImagineTasks",void 0),this.getImagineTasks(),this.job=setInterval(()=>{this.getImagineTasks()},5e3)},unmounted(){clearInterval(this.job)},methods:{onPageChange(e){var t;this.$router.push({name:(t=this.$route.name)==null?void 0:t.toString(),query:{page:e}})},async onCustom(e){this.$emit("custom",e),setTimeout(()=>{var t;this.$router.push({name:(t=this.$route.name)==null?void 0:t.toString(),query:{page:1}})},3e3)},async getImagineTasks(){this.loading||await this.$store.dispatch("midjourney/getImagineTasks",{limit:this.limit,offset:this.offset})}}}),O={key:0,class:"tasks"},B={key:1,class:"tasks"},M={class:"pagination"};function H(e,t,i,$,v,j){const l=o("task-preview"),r=o("el-skeleton-item"),c=o("el-skeleton"),p=o("el-card"),u=o("pagination");return a(),n(d,null,[e.tasks?(a(),n("div",O,[(a(!0),n(d,null,y(e.tasks,(m,T)=>(a(),n("div",{key:T,class:"task"},[s(l,{full:!0,"model-value":m,onCustom:t[0]||(t[0]=C=>e.onCustom(C))},null,8,["model-value"])]))),128))])):(a(),n("div",B,[(a(),n(d,null,y(12,m=>s(p,{key:m,class:"task"},{default:_(()=>[s(c,{animated:""},{template:_(()=>[s(r,{variant:"image",class:"icon-placeholder"}),s(r,{variant:"p",class:"title-placeholder"})]),_:1})]),_:2},1024)),64))])),q("div",M,[s(u,{"current-page":e.page,"page-size":e.limit,total:e.total,onChange:e.onPageChange},null,8,["current-page","page-size","total","onChange"])])],64)}var J=k(G,[["render",H],["__scopeId","data-v-03ba638a"],["__file","D:/react/Nexior/src/components/midjourney/tasks/TaskFullList.vue"]]);const U="https://webhook.acedata.cloud/midjourney",V=f({name:"MidjourneyIndex",components:{TaskFullList:J,ModeSelector:w,ApplicationStatus:A,ElButton:L,FontAwesomeIcon:D},data(){return{prompt:"",elements:[],ignore:""}},computed:{mode(){return this.$store.state.midjourney.mode},service(){return this.$store.state.midjourney.service},application(){return this.$store.state.midjourney.application},credential(){return this.$store.state.midjourney.credential},initializing(){return this.$store.state.midjourney.status.getApplication===h.Request},needApply(){return this.$store.state.midjourney.status.getApplication===h.Success&&!this.application}},async mounted(){await this.onGetApplication()},methods:{async onGenerateNew(){this.$router.push({name:S})},async onGetApplication(){await this.$store.dispatch("midjourney/getApplication")},async onStartTask(e){var i;const t=(i=this.credential)==null?void 0:i.token;if(!t){console.error("no token found");return}b.imagine(e,{token:t}).then(()=>{g.success(this.$t("midjourney.message.startTaskSuccess"))}).catch(()=>{g.error(this.$t("midjourney.message.startTaskFailed"))})},async onCustom(e){const t={image_id:e.image_id,action:e.action,callback_url:U};this.onStartTask(t)}}}),K={class:"history"};function Q(e,t,i,$,v,j){const l=o("mode-selector"),r=o("application-status"),c=o("task-full-list"),p=o("font-awesome-icon"),u=o("el-button");return a(),n("div",K,[s(l,{class:"mb-4"}),s(r,{initializing:e.initializing,application:e.application,"need-apply":e.needApply,class:"mb-4",service:e.service,onRefresh:e.onGetApplication},null,8,["initializing","application","need-apply","service","onRefresh"]),s(c,{onCustom:e.onCustom,onRefresh:e.onGetApplication},null,8,["onCustom","onRefresh"]),s(u,{type:"primary",round:"",class:"btn btn-generate",onClick:e.onGenerateNew},{default:_(()=>[s(p,{icon:"fa-solid fa-chevron-left",class:"icon icon-rotate mr-1"}),P(" "+z(e.$t("midjourney.button.generateNew")),1)]),_:1},8,["onClick"])])}var ce=k(V,[["render",Q],["__scopeId","data-v-638d7e3e"],["__file","D:/react/Nexior/src/pages/midjourney/History.vue"]]);export{ce as default};
