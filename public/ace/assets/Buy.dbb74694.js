import"./vendor-others.11f5dab8.js";import{_ as I,v as S,w as q}from"./index.5f82e941.js";import{d as O,o as n,e as h,P as p,ak as s,H as k,I as t,R as i,f as L,O as b,ah as M,Q as T,M as B,K as P}from"./vendor-@vue.e467cd49.js";import{o as z}from"./order.09a5605b.js";import{s as U,l as G,m as H,q as K,y as Q,A as j,e as J,t as W,B as X,C as Y,D as Z}from"./vendor-element-plus.4011bc9f.js";import"./vendor-highlight.js.5674318b.js";import"./vendor-axios.938e43d7.js";import"./vendor-qrcode.f15bf907.js";import"./vendor-fortawesome.8c26b529.js";const x=O({name:"ApiPrice",props:{price:{type:Number,required:!1,default:0},unit:{type:String,required:!1,default:void 0},start:{type:Boolean,required:!1,default:!1}}}),ee={class:"price-text"},ae={key:0,class:"unfree"},te={key:1,class:"free"};function ie(e,a,o,l,c,v){return n(),h("div",ee,[e.price>0?(n(),h("span",ae,"$"+p(e.price)+" "+p(e.unit?` / ${e.unit}`:"")+p(e.start?e.$t("common.message.startPrice"):""),1)):(n(),h("span",te,p(e.$t("common.message.free")),1))])}var oe=I(x,[["render",ie],["__scopeId","data-v-d195ccd6"],["__file","D:/react/Nexior/src/components/common/Price.vue"]]);const re=O({name:"ConsoleApplicationBuy",components:{ElSkeleton:U,ElRow:G,ElCol:H,ElCard:K,ElForm:Q,ElFormItem:j,ElButton:J,ElDivider:W,ElRadioGroup:X,ElRadioButton:Y,Price:oe},data(){return{application:void 0,loading:!1,form:{packageId:void 0},creating:!1}},computed:{id(){var e,a;return(a=(e=this.$route.params)==null?void 0:e.id)==null?void 0:a.toString()},price(){var e,a,o;return((a=(e=this.application)==null?void 0:e.service)==null?void 0:a.price)&&this.form.amount?this.form.amount*((o=this.application.service)==null?void 0:o.price):0},package(){var e,a,o;if(((a=(e=this.application)==null?void 0:e.service)==null?void 0:a.packages)&&this.form.packageId){const l=(o=this.application.service)==null?void 0:o.packages.filter(c=>c.id===this.form.packageId);if(l.length>0)return l[0]}}},mounted(){this.onFetchApplication()},methods:{onFetchApplication(){this.loading=!0,S.get(this.id).then(({data:e})=>{var a,o,l,c;this.application=e,this.loading=!1,this.form.packageId=(c=(l=(o=(a=this.application)==null?void 0:a.service)==null?void 0:o.packages)==null?void 0:l[0])==null?void 0:c.id}).catch(()=>{this.loading=!1})},onCreateOrder(){var a,o,l,c,v,u,m,$;if(!((a=this.application)!=null&&a.id))return;this.creating=!0;const e=this.$t(`service.unit.${(l=(o=this.application)==null?void 0:o.service)==null?void 0:l.unit}s`);z.create({application_id:(c=this.application)==null?void 0:c.id,amount:(v=this.package)==null?void 0:v.amount,...this.form.packageId!=="custom"&&this.package?{package_id:this.package.id}:{},description:`${(m=(u=this.application)==null?void 0:u.service)==null?void 0:m.title} x ${($=this.package)==null?void 0:$.amount} ${e}`}).then(({data:f})=>{this.creating=!1;const y=f;this.$router.push({name:q,params:{id:y.id}})}).catch(()=>{Z.error(this.$t("order.message.createFailed")),this.creating=!1})}}}),se={class:"title"},ne={key:1,class:P({price:!0,free:!0})};function le(e,a,o,l,c,v){const u=s("el-col"),m=s("el-row"),$=s("el-skeleton"),f=s("el-form-item"),y=s("el-radio-button"),N=s("el-radio-group"),w=s("price"),D=s("el-divider"),F=s("el-button"),R=s("el-form"),V=s("el-card");return n(),k(m,{class:"panel"},{default:t(()=>[i(u,{span:24},{default:t(()=>[i(m,null,{default:t(()=>[i(u,{span:24},{default:t(()=>[L("h2",se,p(e.$t("common.title.buyMore")),1)]),_:1})]),_:1}),i(m,null,{default:t(()=>[i(u,{span:24},{default:t(()=>[i(V,{shadow:"hover"},{default:t(()=>[i(m,null,{default:t(()=>[i(u,{span:12,offset:6},{default:t(()=>[e.loading?(n(),k($,{key:0})):e.application?(n(),k(R,{key:1,"label-width":"100px"},{default:t(()=>[i(f,{label:e.$t("application.field.service")},{default:t(()=>{var r,d;return[b(p((d=(r=e.application)==null?void 0:r.service)==null?void 0:d.title),1)]}),_:1},8,["label"]),i(f,{label:e.$t("application.field.package")},{default:t(()=>{var r,d;return[(d=(r=e.application)==null?void 0:r.service)!=null&&d.packages?(n(),k(N,{key:0,modelValue:e.form.packageId,"onUpdate:modelValue":a[0]||(a[0]=_=>e.form.packageId=_)},{default:t(()=>{var _;return[(n(!0),h(T,null,M((_=e.application)==null?void 0:_.service.packages,(g,A)=>(n(),k(y,{key:A,label:g.id},{default:t(()=>{var E,C;return[b(p(g.amount)+" "+p(e.$t(`service.unit.${(C=(E=e.application)==null?void 0:E.service)==null?void 0:C.unit}s`)),1)]}),_:2},1032,["label"]))),128))]}),_:1},8,["modelValue"])):B("v-if",!0)]}),_:1},8,["label"]),i(f,{label:e.$t("service.field.price")},{default:t(()=>{var r;return[i(w,{price:(r=e.package)==null?void 0:r.price},null,8,["price"])]}),_:1},8,["label"]),i(D,{"border-style":"dashed"}),i(f,{label:e.$t("application.field.shouldPayPrice")},{default:t(()=>{var r,d,_,g;return[e.package?(n(),h("span",{key:0,class:P({price:!0,unfree:((r=e.package)==null?void 0:r.price)>0,free:((d=e.package)==null?void 0:d.price)===0})}," $"+p((g=(_=e.package)==null?void 0:_.price)==null?void 0:g.toFixed(2)),3)):(n(),h("span",ne," $ 0 "))]}),_:1},8,["label"]),i(f,null,{default:t(()=>[i(F,{type:"primary",size:"large",class:"btn-create",loading:e.creating,round:"",onClick:e.onCreateOrder},{default:t(()=>[b(p(e.$t("application.button.createOrder")),1)]),_:1},8,["loading","onClick"])]),_:1})]),_:1})):B("v-if",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}var ke=I(re,[["render",le],["__scopeId","data-v-5881dfca"],["__file","D:/react/Nexior/src/pages/console/application/Buy.vue"]]);export{ke as default};
